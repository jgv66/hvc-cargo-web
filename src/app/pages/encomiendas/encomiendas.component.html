<nav>
    <div class="nav nav-tabs" id="nav-tab" role="tablist">
        <a class="nav-item nav-link" id="nav-contact-tab" data-toggle="tab" href="#nav-contact" role="tab" aria-controls="nav-contact" aria-selected="false"><b>Nueva Encomienda</b></a>
        <a class="nav-item nav-link" id="nav-cliente-tab" data-toggle="tab" href="#nav-cliente" role="tab" aria-controls="nav-ccliente" aria-selected="false"><b>Clientes</b></a>
        <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true"><b>Pendientes</b></a>
        <a class="nav-item nav-link" id="nav-busquedas-tab" data-toggle="tab" href="#nav-busquedas" role="tab" aria-controls="nav-busquedas" aria-selected="false"><b>Buscar</b></a>
        <a class="nav-item nav-link" id="nav-follow-tab" data-toggle="tab" href="#nav-follow" role="tab" aria-controls="nav-seguimiento" aria-selected="false"><b>Seguimientos</b></a>
        <a class="nav-item nav-link" id="nav-masivos-tab" data-toggle="tab" href="#nav-masivos" role="tab" aria-controls="nav-masivos" aria-selected="false"><b>Cambios Masivos</b></a>
    </div>
</nav>
<div class="tab-content" id="nav-tabContent">
    <!-- Nueva Encomienda -->
    <div class="tab-pane fade" id="nav-contact" role="tabpanel" aria-labelledby="nav-contact-tab">
        <div classs="card" style="margin-top: 5px;">
            <div class="progress" *ngIf=" grabando ">
                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;height: 5px;"></div>
            </div>
            <form (ngSubmit)="crearEncomienda()">
                <!-- datos cliente / despachante -->
                <div class="card" style="width: 100%;margin-top:10px;font-size:90%;">
                    <div class="card-body">
                        <h3 class="card-title"><b>Datos del Origen</b></h3>
                        <div class="row" style="margin-top: -38px;">
                            <div class="col-1" style="margin-top: 29px;padding-left:15px;padding-right:5px;">
                                <button type="button" (click)="limpiaDataChica()" data-toggle="modal" data-target="#buscarClientes" class="btn btn-primary btn-block">Buscar</button>
                            </div>
                            <div class="col-4">
                                <label>.</label>
                                <input readonly type="text" class="form-control" name="carga.xnombreCliente" [(ngModel)]="carga.xnombreCliente">
                            </div>
                            <div class="col-2">
                                <label>Rut</label>
                                <input readonly type="text" class="form-control" name="carga.xrutCliente" [(ngModel)]="carga.xrutCliente">
                            </div>
                            <div class="col-3">
                                <label>Email</label>
                                <input readonly type="text" class="form-control" name="carga.xemailCliente" [(ngModel)]="carga.xemailCliente">
                            </div>
                            <div class="col-2">
                                <label>Telefonos</label>
                                <input readonly type="text" class="form-control" name="carga.xfonosCliente" [(ngModel)]="carga.xfonosCliente">
                            </div>
                        </div>
                        <div class="row" style="margin-top: 10px;">
                            <div class="col-md-3">
                                <label>Dirección</label>
                                <input readonly type="text" class="form-control" name="carga.xdireccCliente" [(ngModel)]="carga.xdireccCliente">
                            </div>
                            <div class="col-md-4">
                                <label>Comuna</label>
                                <input readonly type="text" class="form-control" name="carga.xcomunaCliente" [(ngModel)]="carga.xcomunaCliente">
                            </div>
                            <div class="col-md-3">
                                <label>Contacto o Quién entrega?</label>
                                <input clearInput="true" type="text" class="form-control" name="carga.contacto" [(ngModel)]="carga.contacto">
                            </div>
                            <div class="col-md-2" style="padding-left: 5px;">
                                <label>Fecha en destino</label>
                                <input clearInput="true" type="date" class="form-control" name="fecha_prometida" [(ngModel)]="carga.fecha_prometida">
                            </div>
                        </div>
                        <div class="row" style="margin-top: 10px;">
                            <div class="col-md-2">
                                <label>Tipo de Carga</label>
                                <input clearInput="true" type="text" class="form-control" name="carga.obs_carga" [(ngModel)]="carga.obs_carga">
                            </div>
                            <div class="col-md-1">
                                <label>Bultos</label>
                                <input clearInput="true" type="number" class="form-control" name="carga.bultos" [(ngModel)]="carga.bultos">
                            </div>
                            <div class="col-md-1" style="padding-left: 5px;">
                                <label>Peso (Kg)</label>
                                <input clearInput="true" type="number" class="form-control" name="carga.peso" [(ngModel)]="carga.peso">
                            </div>
                            <div class="col-md-1" style="padding-left: 5px;">
                                <label>Vol.(m3)</label>
                                <input clearInput="true" type="number" class="form-control" name="carga.volumen" [(ngModel)]="carga.volumen">
                            </div>
                            <div class="col-md-2">
                                <label>Tipo y Nro.de Documento</label>
                                <input clearInput="true" type="text" class="form-control" name="carga.numero_legal" [(ngModel)]="carga.numero_legal">
                            </div>
                            <div class="col-md-3">
                                <label>Tipo Pago</label>
                                <select class="form-control text-left" name="carga.tipo_pago" [(ngModel)]="carga.tipo_pago">
                                    <option value=""></option>
                                    <option *ngFor="let tp of login.tiposDePago" [value]="tp.tipo_pago">{{ tp.descripcion }}</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label>Valor Encomienda</label>
                                <input clearInput="true" type="number" class="form-control" name="carga.valor_cobrado" [(ngModel)]="carga.valor_cobrado">
                            </div>
                        </div>
                    </div>
                </div>
                <!-- datos del destino / receptor -->
                <div class="card" style="width: 100%;margin-top:10px;font-size:90%;">
                    <div class="card-body">
                        <h3 class="card-title"><b>Datos del Destinatario</b></h3>
                        <div class="row" style="margin-top: -38px;">
                            <div class="col-1" style="margin-top: 29px;padding-left:15px;padding-right:5px;">
                                <button type="button" (click)="limpiaDataChica()" data-toggle="modal" data-target="#buscarDestinos" class="btn btn-primary btn-block">Buscar</button>
                            </div>
                            <div class="col-4">
                                <label>.</label>
                                <input readonly type="text" class="form-control" name="carga.xnombreDestino" [(ngModel)]="carga.xnombreDestino">
                            </div>
                            <div class="col-2">
                                <label>Rut</label>
                                <input readonly type="text" class="form-control" name="carga.xrutDestino" [(ngModel)]="carga.xrutDestino">
                            </div>
                            <div class="col-3">
                                <label>Email</label>
                                <input readonly type="text" class="form-control" name="carga.xemailDestino" [(ngModel)]="carga.xemailDestino">
                            </div>
                            <div class="col-2">
                                <label>Telefonos</label>
                                <input readonly type="text" class="form-control" name="carga.xfonosDestino" [(ngModel)]="carga.xfonosDestino">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <label>Dirección</label>
                                <input readonly type="text" class="form-control" name="carga.xdireccDestino" [(ngModel)]="carga.xdireccDestino">
                            </div>
                            <div class="col-md-5">
                                <label>Comuna</label>
                                <input readonly type="text" class="form-control" name="carga.xcomunaDestino" [(ngModel)]="carga.xcomunaDestino">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="progress" *ngIf=" grabandoEnco ">
                    <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;height: 5px;"></div>
                </div>
                <button type="submit" class="btn btn-primary">Grabar los datos de Encomienda</button>
            </form>
        </div>
    </div>
    <!-- pendientes de transportar -->
    <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
        <mat-progress-bar *ngIf=" buscandoRetiros " style="width: 100%;height: 5px;" color="primary" mode="indeterminate"></mat-progress-bar>
        <div class="form-row mt-2 mb-2">
            <div class="col-3" *ngIf=" filasRetiro > 0 " style="margin-top:10px">
                <mat-form-field appearance="" style="margin-left: 15px;">
                    <mat-label>Filtrar</mat-label>
                    <input matInput (keyup)="aplicarFiltroRetiro( $event )" name="filtroRetiro" [(ngModel)]="filtro" placeholder="digite algo..." #input>
                    <button mat-button *ngIf=" filtro !== '' " matSuffix mat-icon-button aria-label="Clear" (click)=" filtro = '' ">
                        <mat-icon>close</mat-icon>
                    </button>
                </mat-form-field>
            </div>
            <div class="col-2" style="max-height: 50px; height: 50px;margin-left:10px;margin-top:20px;">
                <button type="button" class="btn btn-block btn-primary" (click)="cargarDatosPendientes()">
                    <i class="mdi mdi-refresh mdi-12px"></i>Refrescar
                </button>
            </div>
        </div>
        <mat-table matSort [dataSource]="dsRetiros" style="margin-top: -10px;" class="mat-elevation-z8">
            <ng-container matColumnDef="id_paquete">
                <mat-header-cell *matHeaderCellDef style="max-width: 100px;width: 100px;" mat-sort-header> #Id </mat-header-cell>
                <mat-cell *matCellDef="let element" style="max-width: 100px;width: 100px;"><b> #{{element.id_paquete}} </b></mat-cell>
            </ng-container>
            <ng-container matColumnDef="fecha_creacion">
                <mat-header-cell *matHeaderCellDef style="max-width: 150px;width: 150px;" mat-sort-header>Fecha Creación</mat-header-cell>
                <mat-cell *matCellDef="let element" style="max-width: 150px;width: 150px;"> {{element.fecha_creacion}} </mat-cell>
            </ng-container>
            <ng-container matColumnDef="obs_carga">
                <mat-header-cell *matHeaderCellDef style="max-width: 150px;width: 150px;"> Encomienda </mat-header-cell>
                <mat-cell *matCellDef="let element" style="max-width: 150px;width: 150px;"> {{element.obs_carga}} </mat-cell>
            </ng-container>
            <ng-container matColumnDef="cli_razon">
                <mat-header-cell *matHeaderCellDef style="max-width: 430px;width: 430px;" mat-sort-header> Cliente </mat-header-cell>
                <mat-cell *matCellDef="let element" style="max-width: 430px;width: 430px;"> {{element.cli_razon}} </mat-cell>
            </ng-container>
            <ng-container matColumnDef="des_razon">
                <mat-header-cell *matHeaderCellDef style="max-width: 400px;width: 400px;" mat-sort-header> Destinatario </mat-header-cell>
                <mat-cell *matCellDef="let element" style="max-width: 400px;width: 400px;"> {{element.des_razon}} </mat-cell>
            </ng-container>
            <ng-container matColumnDef="tipo_pago">
                <mat-header-cell *matHeaderCellDef style="max-width: 180px;width: 180px;"> Cobro </mat-header-cell>
                <mat-cell *matCellDef="let element" style="max-width: 180px;width: 180px;font-weight: bold; color: red"> {{element.tipo_pago}} </mat-cell>
            </ng-container>
            <ng-container matColumnDef="estado">
                <mat-header-cell *matHeaderCellDef style="max-width: 200px;width: 200px;" mat-sort-header> Estado </mat-header-cell>
                <mat-cell *matCellDef="let element" style="max-width: 200px;width: 200px;"> {{element.estado}} </mat-cell>
            </ng-container>
            <ng-container matColumnDef="acciones">
                <mat-header-cell *matHeaderCellDef> Acciones </mat-header-cell>
                <mat-cell *matCellDef="let item">
                    <a *ngIf=" login.usuario.admin " (click)="revisarEncomienda( item )" data-toggle="modal" data-target="#EditEncomienda" class="has-arrow waves-effect text-dark" style="margin-top:10px;">
                        <i class="mdi mdi-lead-pencil mdi-24px"></i>
                    </a>&nbsp;
                    <a *ngIf=" login.usuario.admin " (click)="cargarFoto( item )" data-toggle="modal" data-target="#ImagenModal" class="has-arrow waves-effect text-dark" style="margin-top:10px;color:red;">
                        <i class="mdi mdi-camera mdi-24px "></i>
                    </a>
                    <a *ngIf=" login.usuario.admin " (click)="cambiodeEstado( item )" data-toggle="modal" data-target="#EditEstados" class="has-arrow waves-effect text-dark" style="margin-top:10px;">
                        <i class="mdi mdi-checkbox-marked-circle-outline mdi-24px "></i>
                    </a>&nbsp;
                    <a *ngIf=" login.usuario.admin " (click)="borrarEncomienda( item )" class="has-arrow waves-effect text-dark" style="margin-top:10px;color:red;">
                        <i class="mdi mdi-delete mdi-24px "></i>
                    </a>
                </mat-cell>
            </ng-container>
            <ng-container matColumnDef="detalleRetiros">
                <mat-cell *matCellDef="let detail" [attr.colspan]="dispColumns.length">
                    <table class="table table-striped table-hover table-sm">
                        <tbody translate="no">
                            <tr>
                                <td scope="row" style="width: 69px;"></td>
                                <td scope="row" style="width: 150px;">
                                    <p><i class="mdi mdi-clock-fast mdi-18px"></i> {{ detail.element.hora_creacion }}</p>
                                    <p><i class="mdi mdi-calendar-question mdi-18px"></i> {{ detail.element.fecha_prometida }}</p>
                                </td>
                                <td scope="row" style="width: 150px;">
                                    <p><i class="mdi mdi-package-variant-closed mdi-18px"></i> {{ detail.element.bultos }} </p>
                                    <p><i class="mdi mdi-weight-kilogram mdi-18px"></i> {{ detail.element.peso | number:"1.0-2" }}Kg </p>
                                </td>
                                <td scope="row" style="width: 300px;">
                                    <p>{{ detail.element.cli_direccion }}, {{ detail.element.cli_comuna}} </p>
                                    <p>{{ detail.element.contacto }}</p>
                                    <p>{{ detail.element.cli_referencias }}</p>
                                </td>
                                <td scope="row" style="width: 310px;">
                                    <p style="margin-left: 5px;">{{ detail.element.des_direccion }}, {{ detail.element.des_comuna}} </p>
                                </td>
                                <td style="max-width: 180px;width: 180px;padding-top: 18px; font-weight: bold; color: red" scope="row">
                                    <p>${{ detail.element.valor_cobrado | number:"1.0-0"}}</p>
                                </td>
                                <td scope="row" style="max-width: 180px;width: 180px;">
                                    <p><i class="mdi mdi-calendar-clock mdi-18px"></i> {{ detail.element.asignacion }}</p>
                                    <p><i class="mdi mdi-clock-fast mdi-18px"></i> {{ detail.element.hora_asignacion }}</p>
                                    <p><i class="mdi mdi-account-settings mdi-18px"></i> {{ detail.element.pickeador }}</p>
                                </td>
                                <td class="text-center">
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </mat-cell>
            </ng-container>
            <mat-header-row *matHeaderRowDef="dispColumns"></mat-header-row>
            <mat-row *matRowDef="let row; columns: dispColumns;" class="element-row" [class.expanded]="expandedElementR == row" (click)="expandedElementR = row"></mat-row>
            <mat-row *matRowDef="let row; columns: ['detalleRetiros']; when: isExpansionDetailRowR" [@detailExpand]="row.element == expandedElementR ? 'expanded' : 'collapsed'" style="overflow: hidden"></mat-row>
        </mat-table>
        <mat-paginator [hidePageSize]="true" [length]="filasRetiro" [pageSize]="16" [pageSizeOptions]="[16, 32, 64]" showFirstLastButtons></mat-paginator>
    </div>
    <!-- clientes -->
    <div class="tab-pane fade" id="nav-cliente" role="tabpanel" aria-labelledby="nav-cliente-tab">
        <div classs="card" style="margin-top: 5px;">
            <!-- buscar clientes -->
            <form (ngSubmit)="buscarClientes()">
                <div class="form-row mt-2 mb-2">
                    <div class="col-3" style="padding-left: 20px;">
                        <mat-form-field appearance="" style="max-height:50px;height:50px;">
                            <mat-label>Buscar Clientes</mat-label>
                            <input matInput placeholder="digite algo del nombre o rut..." name="nombreorut" [(ngModel)]="nombreorut">
                            <button mat-button *ngIf="nombreorut" matSuffix mat-icon-button aria-label="Clear" (click)="nombreorut=''">
                                <mat-icon>close</mat-icon>
                            </button>
                        </mat-form-field>
                    </div>
                    <div class="col-1" style="max-height: 50px; height: 50px;">
                        <button type="submit" class="btn btn-primary btn-block" style="margin-top: 10px;">Buscar</button>
                    </div>
                    <div class="col-1" style="max-height: 50px; height: 50px;margin-left:10px;" (click)="crearCliente()" data-toggle="modal" data-target="#ModalCenteredCrear">
                        <button type="button" class="btn btn-primary" style="margin-top: 10px;"><i class="mdi mdi-plus-circle-outline mdi-12px"></i>
                            Crear
                        </button>
                    </div>
                </div>
            </form>
            <div class="progress" *ngIf=" buscando ">
                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;height: 5px;"></div>
            </div>
            <mat-table [dataSource]="dsClientes" style="margin-top: -10px;" class="mat-elevation-z8">
                <ng-container matColumnDef="rut">
                    <mat-header-cell *matHeaderCellDef style="flex:10%;"> Rut </mat-header-cell>
                    <mat-cell *matCellDef="let element" style="flex:10%;"><b> {{element.rut}} </b></mat-cell>
                </ng-container>
                <ng-container matColumnDef="razon_social">
                    <mat-header-cell *matHeaderCellDef style="flex:20%;"> Razon Social / Nombre Fantasía </mat-header-cell>
                    <mat-cell *matCellDef="let element" style="flex:20%;"> {{element.razon_social}} - {{ element.nombre_fantasia }}</mat-cell>
                </ng-container>
                <ng-container matColumnDef="direccion">
                    <mat-header-cell *matHeaderCellDef style="flex:20%;"> Direccion </mat-header-cell>
                    <mat-cell *matCellDef="let element" style="flex:20%;"> {{element.direccion}} - {{ element.comuna }} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="telefono1">
                    <mat-header-cell *matHeaderCellDef style="flex:10%;"> Teléfonos </mat-header-cell>
                    <mat-cell *matCellDef="let element" style="flex:10%;"> {{element.telefono1}} - {{element.telefono2}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="email">
                    <mat-header-cell *matHeaderCellDef style="flex:15%;"> Email </mat-header-cell>
                    <mat-cell *matCellDef="let element" style="flex:15%;"> {{element.email}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="acciones">
                    <mat-header-cell *matHeaderCellDef style="flex:5%;"> Acciones </mat-header-cell>
                    <mat-cell *matCellDef="let item" style="flex:5%;">
                        <a (click)="editarCliente( item )" data-toggle="modal" data-target="#ModalCenteredCrear" class="has-arrow waves-effect text-dark" style="margin-top:10px;"><i class="mdi mdi-lead-pencil mdi-24px"></i></a>
                    </mat-cell>
                </ng-container>
                <mat-header-row *matHeaderRowDef="dispColClientes"></mat-header-row>
                <mat-row *matRowDef="let row; columns: dispColClientes;"></mat-row>
            </mat-table>
            <mat-paginator [hidePageSize]="true" [length]="filasClientes" [pageSize]="10" [pageSizeOptions]="[10, 20, 500]" showFirstLastButtons></mat-paginator>
        </div>
    </div>
    <!-- busquedas -->
    <div class="tab-pane fade" id="nav-busquedas" role="tabpanel" aria-labelledby="nav-busquedas-tab">
        <div classs="card" style="margin-top: 5px;">
            <form (ngSubmit)="buscarPaquetes('buscar')">
                <div class="form-row mt-2 mb-2">
                    <section class="col-2.8">
                        <label class="example-margin">Buscar por:</label>
                        <mat-radio-group name="nBuscarPor" [(ngModel)]="nBuscarPor">
                            <mat-radio-button style="padding-top: 10px;" class="example-margin" value="fecha">Fecha</mat-radio-button>
                            <mat-radio-button class="example-margin" value="numero">Número</mat-radio-button>
                        </mat-radio-group>
                    </section>
                    <!-- seleccion por fecha -->
                    <div class="col-2" style="padding-left: 20px;" [hidden]="nBuscarPor==='numero'">
                        <mat-form-field appearance="" style="max-height: 50px; height: 50px;width:125px;">
                            <mat-label>Fecha inicial</mat-label>
                            <input matInput [matDatepicker]="picker" name="fechaIni" [(ngModel)]="fechaIni">
                            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                            <mat-datepicker #picker></mat-datepicker>
                        </mat-form-field>
                    </div>
                    <div class="col-2" [hidden]="nBuscarPor==='numero'">
                        <mat-form-field color="accent" appearance="" style="max-height: 50px; height: 50px;width:125px;">
                            <mat-label>Fecha final</mat-label>
                            <input matInput [matDatepicker]="picker2" name="fechaFin" [(ngModel)]="fechaFin">
                            <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                            <mat-datepicker #picker2></mat-datepicker>
                        </mat-form-field>
                    </div>
                    <!-- seleccion por numero de encomienda -->
                    <div class="col-2" style="padding-left: 20px;" [hidden]="nBuscarPor==='fecha'">
                        <mat-form-field appearance="" style="max-height: 50px; height: 50px;width:125px;">
                            <mat-label>#Id Inicial</mat-label>
                            <input matInput type="number" name="nIdIni" [(ngModel)]="nIdIni">
                        </mat-form-field>
                    </div>
                    <div class="col-1.5" [hidden]="nBuscarPor==='fecha'">
                        <mat-form-field color="accent" appearance="" style="max-height: 50px; height: 50px;width:125px;">
                            <mat-label>#Id Final</mat-label>
                            <input matInput type="number" name="nIdFin" [(ngModel)]="nIdFin">
                        </mat-form-field>
                    </div>

                    <div class="col-1.5" style="max-height: 50px; height: 50px;">
                        <button type="submit" class="btn btn-primary" style="margin-top: 10px;">Buscar Encomiendas</button>
                    </div>
                    <div class="col-3" *ngIf=" filasBusqueda > 0 ">
                        <mat-form-field *ngIf=" filasBusqueda > 0 ">
                            <mat-label>Filtrar</mat-label>
                            <input matInput (keyup)="aplicarFiltroBusquedasB( $event )" placeholder="digite algo..." #input>
                        </mat-form-field>
                    </div>
                </div>
            </form>
            <div class="progress" *ngIf=" buscando ">
                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;height: 5px;"></div>
            </div>
            <mat-table [dataSource]="dsBusquedas" style="margin-top: -10px;" class="mat-elevation-z8">
                <ng-container matColumnDef="id_paquete">
                    <mat-header-cell *matHeaderCellDef style="max-width: 100px;width: 100px;"> #Id </mat-header-cell>
                    <mat-cell *matCellDef="let element" style="max-width: 100px;width: 100px;"><b> #{{element.id_paquete}} </b></mat-cell>
                </ng-container>
                <ng-container matColumnDef="fecha_creacion">
                    <mat-header-cell *matHeaderCellDef style="max-width: 150px;width: 150px;">Fecha Creación</mat-header-cell>
                    <mat-cell *matCellDef="let element" style="max-width: 150px;width: 150px;"> {{element.fecha_creacion}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="obs_carga">
                    <mat-header-cell *matHeaderCellDef style="max-width: 150px;width: 150px;"> Encomienda </mat-header-cell>
                    <mat-cell *matCellDef="let element" style="max-width: 150px;width: 150px;"> {{element.obs_carga}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="cli_razon">
                    <mat-header-cell *matHeaderCellDef style="max-width: 400px;width: 400px;"> Cliente </mat-header-cell>
                    <mat-cell *matCellDef="let element" style="max-width: 400px;width: 400px;"> {{element.cli_razon}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="des_razon">
                    <mat-header-cell *matHeaderCellDef style="max-width: 400px;width: 400px;"> Destinatario </mat-header-cell>
                    <mat-cell *matCellDef="let element" style="max-width: 400px;width: 400px;"> {{element.des_razon}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="tipo_pago">
                    <mat-header-cell *matHeaderCellDef style="max-width: 180px;width: 180px;"> Cobro </mat-header-cell>
                    <mat-cell *matCellDef="let element" style="max-width: 180px;width: 180px;font-weight: bold; color: red"> {{element.tipo_pago}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="estado">
                    <mat-header-cell *matHeaderCellDef style="max-width: 200px;width: 200px;"> Estado </mat-header-cell>
                    <mat-cell *matCellDef="let element" style="max-width: 200px;width: 200px;"> {{element.estado}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="acciones">
                    <mat-header-cell *matHeaderCellDef> Acciones </mat-header-cell>
                    <mat-cell *matCellDef="let item">
                        <a *ngIf=" login.usuario.admin " (click)="revisarEncomienda( item )" data-toggle="modal" data-target="#EditEncomienda" class="has-arrow waves-effect text-dark" style="margin-top:10px;">
                            <i class="mdi mdi-lead-pencil mdi-24px"></i>
                        </a>&nbsp;
                        <a *ngIf=" login.usuario.admin " (click)="cargarFoto( item )" data-toggle="modal" data-target="#ImagenModal" class="has-arrow waves-effect text-dark" style="margin-top:10px;color:red;">
                            <i class="mdi mdi-camera mdi-24px "></i>
                        </a>&nbsp;
                        <a *ngIf=" login.usuario.admin " (click)="cambiodeEstado( item )" data-toggle="modal" data-target="#EditEstados" class="has-arrow waves-effect text-dark" style="margin-top:10px;">
                            <i class="mdi mdi-checkbox-marked-circle-outline mdi-24px "></i>
                        </a>&nbsp;
                        <a *ngIf=" login.usuario.admin " (click)="borrarEncomienda( item )" class="has-arrow waves-effect text-dark" style="margin-top:10px;color:red;">
                            <i class="mdi mdi-delete mdi-24px "></i>
                        </a>
                    </mat-cell>
                </ng-container>
                <!-- datos adicionales -->
                <ng-container matColumnDef="expandedDetail">
                    <mat-cell *matCellDef="let detail">
                        <table class="table table-striped table-hover table-sm">
                            <tbody translate="no">
                                <tr>
                                    <td scope="row" style="width: 69px;"></td>
                                    <td scope="row" style="width: 150px;">
                                        <p><i class="mdi mdi-clock-fast mdi-18px"></i> {{ detail.element.hora_creacion }}</p>
                                        <p><i class="mdi mdi-calendar-question mdi-18px"></i> {{ detail.element.fecha_prometida }}</p>
                                    </td>
                                    <td scope="row" style="width: 150px;">
                                        <p><i class="mdi mdi-package-variant-closed mdi-18px"></i> {{ detail.element.bultos }} </p>
                                        <p><i class="mdi mdi-weight-kilogram mdi-18px"></i> {{ detail.element.peso | number:"1.0-2" }}Kg </p>
                                    </td>
                                    <td scope="row" style="width: 312px;">
                                        <p>{{ detail.element.cli_direccion }}, {{ detail.element.cli_comuna}} </p>
                                        <p>{{ detail.element.contacto }}</p>
                                        <p>{{ detail.element.cli_referencias }}</p>
                                    </td>
                                    <td scope="row" style="width: 315px;">
                                        <p>{{ detail.element.des_direccion }}, {{ detail.element.des_comuna}} </p>
                                    </td>
                                    <td style="max-width: 180px;width: 180px;padding-top: 18px; font-weight: bold; color: red" scope="row">
                                        <p>${{ detail.element.valor_cobrado | number:"1.0-0"}}</p>
                                    </td>
                                    <td scope="row" style="max-width: 180px;width: 180px;">
                                        <p><i class="mdi mdi-calendar-clock mdi-18px"></i> {{ detail.element.asignacion }}</p>
                                        <p><i class="mdi mdi-clock-fast mdi-18px"></i> {{ detail.element.hora_asignacion }}</p>
                                        <p><i class="mdi mdi-account-settings mdi-18px"></i> {{ detail.element.pickeador }}</p>
                                    </td>
                                    <td class="text-center">
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </mat-cell>
                </ng-container>

                <mat-header-row *matHeaderRowDef="dispColumns"></mat-header-row>
                <mat-row *matRowDef="let row; columns: dispColumns;" matRipple class="element-row" [class.expanded]="expandedElementB == row" (click)="expandedElementB = row"></mat-row>
                <mat-row *matRowDef="let row; columns: ['expandedDetail']; when: isExpansionDetailRowB" [@detailExpand]="row.element == expandedElementB ? 'expanded' : 'collapsed'" style="overflow: hidden"></mat-row>

            </mat-table>
            <mat-paginator [hidePageSize]="true" [length]="filasBusqueda" [pageSize]="20" [pageSizeOptions]="[20, 40, 100]" showFirstLastButtons></mat-paginator>
        </div>
    </div>
    <!-- seguimientos -->
    <div class="tab-pane fade" id="nav-follow" role="tabpanel" aria-labelledby="nav-seguimiento-tab">
        <div classs="card" style="margin-top: 5px;">
            <!-- buscar paquete -->
            <form (ngSubmit)="buscarPaquete()">
                <div class="form-row mt-2 mb-2">
                    <div class="col-2" style="padding-left: 20px;">
                        <mat-form-field color="accent" appearance="" style="max-height: 50px; height: 50px;">
                            <mat-label>#Encomienda</mat-label>
                            <input matInput name="idpqt" [(ngModel)]="idpqt" placeholder="digite el ID de seguimiento...">
                            <button mat-button *ngIf="idpqt" matSuffix mat-icon-button aria-label="Clear" (click)="idpqt=0">
                                <mat-icon>close</mat-icon>
                            </button>
                        </mat-form-field>
                    </div>
                    <div class="col-2" style="max-height: 50px; height: 50px;margin-left:70px;">
                        <button type="submit" class="btn btn-primary" style="margin-top: 10px;">Buscar</button>
                    </div>
                    <a *ngIf=" login.usuario.admin && idpqt !== undefined && idpqt !== 0 " (click)="cargarFotoFea( idpqt )" data-toggle="modal" data-target="#ImagenModal" class="has-arrow waves-effect text-dark" style="margin-top:10px;color:red;">
                        <i class="mdi mdi-camera mdi-24px "></i>
                    </a>&nbsp;
                </div>
            </form>
            <div class="progress" *ngIf=" buscandoID ">
                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;height: 5px;"></div>
            </div>
            <mat-table [dataSource]="dsSeguimiento" style="margin-top: -10px;" class="mat-elevation-z8">
                <ng-container matColumnDef="id">
                    <mat-header-cell *matHeaderCellDef> #ID </mat-header-cell>
                    <mat-cell *matCellDef="let element"> #{{element.id}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="id_paquete">
                    <mat-header-cell *matHeaderCellDef> #Seguimiento </mat-header-cell>
                    <mat-cell *matCellDef="let element"> #{{element.id_paquete}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="fecha">
                    <mat-header-cell *matHeaderCellDef> Fecha creación </mat-header-cell>
                    <mat-cell *matCellDef="let element"> {{element.fecha}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="hora">
                    <mat-header-cell *matHeaderCellDef> Hora </mat-header-cell>
                    <mat-cell *matCellDef="let element"> {{element.hora}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="usuario">
                    <mat-header-cell *matHeaderCellDef> Usuario </mat-header-cell>
                    <mat-cell *matCellDef="let element"> {{element.nombre}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="notas">
                    <mat-header-cell *matHeaderCellDef> Comentarios </mat-header-cell>
                    <mat-cell *matCellDef="let element"> {{element.comentario}} </mat-cell>
                </ng-container>
                <mat-header-row *matHeaderRowDef="dispColSeguimiento"></mat-header-row>
                <mat-row *matRowDef="let row; columns: dispColSeguimiento;"></mat-row>
            </mat-table>
        </div>
    </div>
    <!-- masivos -->
    <div class="tab-pane fade" id="nav-masivos" role="tabpanel" aria-labelledby="nav-masivos-tab">
        <div classs="card" style="margin-top: 5px;">
            <form (ngSubmit)="buscarPaquetes('masivo')">
                <div class="form-row mt-2 mb-2">
                    <div class="col-2" style="padding-left: 20px;">
                        <mat-form-field appearance="" style="max-height: 50px; height: 50px;width:125px;">
                            <mat-label>#Id Inicial</mat-label>
                            <input matInput type="number" name="idIni" [(ngModel)]="idIni">
                        </mat-form-field>
                    </div>
                    <div class="col-2">
                        <mat-form-field color="accent" appearance="" style="max-height: 50px; height: 50px;width:125px;">
                            <mat-label>#Id Final</mat-label>
                            <input matInput type="number" name="idFin" [(ngModel)]="idFin">
                        </mat-form-field>
                    </div>
                    <div class="col-2" style="max-height: 50px; height: 50px;">
                        <button type="submit" class="btn btn-primary" style="margin-top: 10px;">Buscar para Actualizar</button>
                    </div>
                    <div class="col-2" style="max-height: 50px; height: 50px;margin-left:20px; top:-9px; right:45px;" *ngIf=" filasMasivos>0 && selection.selected.length ">
                        <a *ngIf=" login.usuario.admin " (click)="cambiodeEstadoMasivo()" data-toggle="modal" data-target="#EditEstadosMasivos" class="has-arrow waves-effect text-dark" style="margin-top:10px;">
                            <b><i class="mdi mdi-checkbox-marked-circle-outline mdi-48px "></i></b>
                        </a>
                    </div>
                </div>
            </form>
            <mat-progress-bar *ngIf=" buscandoMasivo===true && marcaRojo===false " style="width: 100%;height: 5px;" color="primary" mode="indeterminate"></mat-progress-bar>
            <mat-progress-bar *ngIf=" buscandoMasivo===true && marcaRojo===true  " style="width: 100%;height: 5px;" color="warn" mode="indeterminate"></mat-progress-bar>
            <div class="fix-container">
                <mat-table [dataSource]="dsMasivos" style="margin-top: -10px;" class="mat-elevation-z8">
                    <ng-container matColumnDef="select">
                        <mat-header-cell *matHeaderCellDef style="max-width: 80px;width: 80px;">
                            <mat-checkbox (change)="$event ? masterToggle() : null" [checked]="selection.hasValue() && isAllSelected()" [indeterminate]="selection.hasValue() && !isAllSelected()" [aria-label]="checkboxLabel()"></mat-checkbox>
                        </mat-header-cell>
                        <mat-cell *matCellDef="let row" style="max-width: 80px;width: 80px;">
                            <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? selection.toggle(row) : null" [checked]="selection.isSelected(row)" [aria-label]="checkboxLabel(row)"></mat-checkbox>
                        </mat-cell>
                    </ng-container>
                    <ng-container matColumnDef="estado">
                        <mat-header-cell *matHeaderCellDef style="max-width: 200px;width: 200px;"> Estado </mat-header-cell>
                        <mat-cell *matCellDef="let element" style="max-width: 200px;width: 200px;"> {{element.estado}} </mat-cell>
                    </ng-container>
                    <ng-container matColumnDef="id_paquete">
                        <mat-header-cell *matHeaderCellDef style="max-width: 100px;width: 100px;"> #Id </mat-header-cell>
                        <mat-cell *matCellDef="let element" style="max-width: 100px;width: 100px;"><b> #{{element.id_paquete}} </b></mat-cell>
                    </ng-container>
                    <ng-container matColumnDef="fecha_creacion">
                        <mat-header-cell *matHeaderCellDef style="max-width: 150px;width: 150px;">Fecha Creación</mat-header-cell>
                        <mat-cell *matCellDef="let element" style="max-width: 150px;width: 150px;"> {{element.fecha_creacion}} </mat-cell>
                    </ng-container>
                    <ng-container matColumnDef="obs_carga">
                        <mat-header-cell *matHeaderCellDef style="max-width: 150px;width: 150px;"> Encomienda </mat-header-cell>
                        <mat-cell *matCellDef="let element" style="max-width: 150px;width: 150px;"> {{element.obs_carga}} </mat-cell>
                    </ng-container>
                    <ng-container matColumnDef="cli_razon">
                        <mat-header-cell *matHeaderCellDef style="max-width: 400px;width: 400px;"> Cliente </mat-header-cell>
                        <mat-cell *matCellDef="let element" style="max-width: 400px;width: 400px;"> {{element.cli_razon}} </mat-cell>
                    </ng-container>
                    <ng-container matColumnDef="des_razon">
                        <mat-header-cell *matHeaderCellDef style="max-width: 400px;width: 400px;"> Destinatario </mat-header-cell>
                        <mat-cell *matCellDef="let element" style="max-width: 400px;width: 400px;"> {{element.des_razon}} </mat-cell>
                    </ng-container>
                    <ng-container matColumnDef="tipo_pago">
                        <mat-header-cell *matHeaderCellDef style="max-width: 180px;width: 180px;"> Cobro </mat-header-cell>
                        <mat-cell *matCellDef="let element" style="max-width: 180px;width: 180px;font-weight: bold; color: red"> {{element.tipo_pago}} </mat-cell>
                    </ng-container>
                    <mat-header-row *matHeaderRowDef="dispMasivos; sticky: true"></mat-header-row>
                    <mat-row *matRowDef="let row; columns: dispMasivos;" (click)="selection.toggle(row)"></mat-row>
                </mat-table>
            </div>
        </div>
    </div>
</div>

<!-- Modal que despliega la foto -->
<div class="modal fade" id="ImagenModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content" style="width: 670px;">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Imagen de Encomienda <b>( #{{ idfoto }} )</b></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" *ngFor="let foto of lasFotos">
                <p>Fecha {{ foto.fecha }} - Hora {{ foto.hora }}</p>
                <img [src]="foto.imgb64" style="width: 100%;">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>
<!-- Modal buscar clientes -->
<div class="modal fade" id="buscarClientes" tabindex="-1" role="dialog" aria-labelledby="#buscarClientes" aria-hidden="true">
    <div class="modal-dialog modal-xl" style="max-width: 950px;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Buscar clientes</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <!-- buscar clientes -->
            <div class="row" style="margin-top: 10px;">
                <div class="col-10" style="margin-top: 10px; border-left-width: 17px; margin-left: 17px;">
                    <input class="form-control col-9" type="text" name="buscarCliente" [(ngModel)]="buscarCliente">
                </div>
                <div class="col-1" style="margin-top: 10px;">
                    <button type="button" (click)="buscarClientesChico()" class="btn btn-outline-dark mb-2">Buscar</button>
                </div>
            </div>
            <div class="progress" *ngIf=" buscandoChico ">
                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;height: 5px;"></div>
            </div>

            <div class="modal-body">
                <table class="table table-sm">
                    <thead class="bg-dark text-light">
                        <tr translate="no">
                            <th scope="col" style="width:100px;">RUT</th>
                            <th scope="col" style="width:250px;">Razón Social</th>
                            <th scope="col" style="width:300px;">Dirección</th>
                            <th scope="col" style="width:200px;">Comuna</th>
                        </tr>
                    </thead>
                    <tbody translate="no" class="text-dark fuente75">
                        <tr *ngFor="let item of clienteChico" data-dismiss="modal" (click)="esteClienteDestino( item, true )">
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{item.rut}}</p>
                            </td>
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{ item.razon_social }}</p>
                                <p>{{ item.nombre_fantasia }}</p>
                            </td>
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{ item.direccion }}</p>
                            </td>
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{ item.comuna }}</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>
<!-- Modal buscar destinatarios -->
<div class="modal fade" id="buscarDestinos" tabindex="-1" role="dialog" aria-labelledby="#buscarDestinos" aria-hidden="true">
    <div class="modal-dialog modal-xl" style="max-width: 950px;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Buscar Destinatarios</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <!-- buscar clientes -->
            <div class="row" style="margin-top: 10px;">
                <div class="col-10" style="margin-top: 10px; border-left-width: 17px; margin-left: 17px;">
                    <input class="form-control col-9" type="text" name="buscarCliente" [(ngModel)]="buscarCliente">
                </div>
                <div class="col-1" style="margin-top: 10px;">
                    <button type="button" (click)="buscarClientesChico()" class="btn btn-outline-dark mb-2">Buscar</button>
                </div>
            </div>
            <div class="progress" *ngIf=" buscandoChico ">
                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;height: 5px;"></div>
            </div>

            <div class="modal-body">
                <table class="table table-sm">
                    <thead class="bg-dark text-light">
                        <tr translate="no">
                            <th scope="col" style="width:100px;">RUT</th>
                            <th scope="col" style="width:250px;">Razón Social</th>
                            <th scope="col" style="width:300px;">Dirección</th>
                            <th scope="col" style="width:200px;">Comuna</th>
                        </tr>
                    </thead>
                    <tbody translate="no" class="text-dark fuente75">
                        <tr *ngFor="let item of clienteChico" data-dismiss="modal" (click)="esteClienteDestino( item, false )">
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{item.rut}}</p>
                            </td>
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{ item.razon_social }}</p>
                                <p>{{ item.nombre_fantasia }}</p>
                            </td>
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{ item.direccion }}</p>
                            </td>
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{ item.comuna }}</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>
<!-- Modal crear/modificar cliente -->
<div class="modal fade" id="ModalCenteredCrear" tabindex="-1" role="dialog" aria-labelledby="ModalCenteredCrearLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content" style="width: 670px;">
            <div class="modal-header">
                <h4 class="modal-title" id="ModalCenteredCrearLabel">Mantención de Clientes</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form #regCliForm="ngForm">
                    <div class="row">
                        <div class="col-12" style="margin-top: 10px;">
                            <input class="form-control col-12" type="text" placeholder="RUT" #rut="ngModel" name="rut" [(ngModel)]="linea.rut" required minlength="7" value="sin-rut">
                            <div [hidden]=" rut.valid || rut.pristine " class="alert alert-danger">
                                Valor mínimo es de 7 dígitos o puede digitar <b>sin-rut</b>
                            </div>
                        </div>
                        <div class="col-12" style="margin-top: 10px;">
                            <input class="form-control col-12" type="text" placeholder="Nombre o Razón social" #razon="ngModel" name="razon" [(ngModel)]="linea.razon_social" required minlength="2">
                            <div [hidden]=" razon.valid || razon.pristine " class="alert alert-danger">
                                Este campo debe contener la Razón Social
                            </div>
                        </div>
                        <div class="col-12" style="margin-top: 10px;">
                            <input class="form-control col-12" type="text" placeholder="Nombre de fantasía" name="fantasia" [(ngModel)]="linea.nombre_fantasia">
                        </div>
                        <div class="col-12" style="margin-top: 10px;">
                            <input class="form-control col-12" type="text" placeholder="Dirección del cliente" #direccion="ngModel" name="direccion" [(ngModel)]="linea.direccion" required minlength="2">
                            <div [hidden]=" direccion.valid || direccion.pristine " class="alert alert-danger">
                                Sin esta información no podremos ubicarlo... OBVIO !!!
                            </div>
                        </div>
                        <div class="col-12" style="margin-top: 10px;">
                            <select class="form-control col-12 text-left" #comuna="ngModel" name="comuna" [(ngModel)]="linea.comuna" required>
                                <option value="">Comuna (seleccione de la lista)</option>
                                <option *ngFor="let comu of login.ciudadesPermitidas" [value]="comu.ciudad">{{ comu.ciudad }}</option>
                            </select>
                            <div [hidden]=" comuna.valid || comuna.pristine " class="alert alert-danger">
                                Esta información es muy útil además de ser obligatoria...
                            </div>
                        </div>
                        <div class="col-12" style="margin-top: 10px;">
                            <input class="form-control col-12" type="text" placeholder="Número de teléfono o celular" #fono="ngModel" name="fono" [(ngModel)]="linea.telefono1" required minlength="7">
                            <div [hidden]=" fono.valid || fono.pristine " class="alert alert-danger">
                                Requerida para ubicar a nuestros clientes...
                            </div>
                        </div>
                        <div class="col-12" style="margin-top: 10px;">
                            <input class="form-control col-12" type="text" placeholder="Otro número telefónico (alternativo)" name="telefono2" [(ngModel)]="linea.telefono2">
                        </div>
                        <div class="col-12" style="margin-top: 10px;">
                            <input class="form-control col-12" type="email" placeholder="Email o correo electrónico" name="email" [(ngModel)]="linea.email" email>
                        </div>
                        <div class="col-12" style="margin-top: 10px; margin-bottom: 23px;">
                            <input class="form-control col-12" type="text" name="referencias" [(ngModel)]="linea.referencias" placeholder="Ubicación, proximidad o cruce referencial...">
                        </div>
                    </div>
                </form>
                <div class="modal-footer">
                    <div class="example-label" style="margin-right: 50px;">Campos con borde rojo son obligatorios</div>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-primary" [disabled]=" !regCliForm.valid " data-dismiss="modal" (click)="grabarCliente( regCliForm )">Grabar y actualizar</button>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Modal editar encomienda -->
<div class="modal fade" id="EditEncomienda" tabindex="-1" role="dialog" aria-labelledby="EditEncomiendaLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content" style="width: 670px;">
            <div class="modal-header">
                <h4 class="modal-title" id="ModalCenteredCrearLabel">Datos Editables de la Encomienda <b>( #{{ encomienda['id_paquete'] }} )</b></h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="row" style="margin-top: 10px;">
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label">Cliente</label>
                        <input readonly class="form-control col-9" type="text" name="razon" [(ngModel)]="encomienda['cli_razon']">
                    </div>
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label">Contacto</label>
                        <input class="form-control col-9" type="text" name="contacto" [(ngModel)]="encomienda['contacto']">
                    </div>
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label">Fecha destino</label>
                        <input class="form-control col-4" type="date" name="encomienda.llegada" [(ngModel)]="encomienda['llegada']">
                        <label class="col-2 col-form-label text-right">Valor</label>
                        <input class="form-control col-3" type="number" name="valor" [(ngModel)]="encomienda['valor_cobrado']">
                    </div>
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label text-left">Tipo Pago</label>
                        <select class="form-control text-left col-9" name="tipo_pago" [(ngModel)]="encomienda['tipo_pago']" styles="max-width: 478px;">
                            <option value=""></option>
                            <option *ngFor="let tp of login.tiposDePago" [value]="tp.tipo_pago">{{ tp.descripcion }}</option>
                        </select>
                    </div>
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label">Tipo Carga</label>
                        <input class="form-control col-9" type="text" name="carga" [(ngModel)]="encomienda['obs_carga']">
                    </div>
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label">Bultos</label>
                        <input class="form-control col-3" type="number" name="bultos" [(ngModel)]="encomienda['bultos']">
                        <label class="col-3 col-form-label text-right">Peso (Kg)</label>
                        <input class="form-control col-3" type="number" name="peso" [(ngModel)]="encomienda['peso']">
                    </div>
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label">Volumen (m3)</label>
                        <input class="form-control col-2" type="number" name="volumen" [(ngModel)]="encomienda['volumen']">
                        <label class="col-4 col-form-label text-right">Tipo y Nro.Doc.Legal</label>
                        <input class="form-control col-3" type="text" name="numero_legal" [(ngModel)]="encomienda['numero_legal']">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="updateEncomienda()">Grabar y actualizar</button>
            </div>
        </div>
    </div>
    <!-- 
                </div>
         -->
</div>
<!-- Modal estados de la encomienda -->
<div class="modal fade" id="EditEstados" tabindex="-1" role="dialog" aria-labelledby="EditEstadosLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered" role="document">
        <div class="modal-content" style="width:670px;">
            <div class="modal-header">
                <h4 class="modal-title" id="ModalCenteredCrearLabel">Estados de la Encomienda <b>( #{{ this.idpqt }} )</b></h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body modal-body-scroll">
                <table class="table table-sm table-striped table-condensed" cellpadding="0" cellspacing="0">
                    <thead class="bg-dark text-light">
                        <tr translate="no">
                            <th scope="col" style="width:40px;"> </th>
                            <th scope="col" style="width:90px;">Estado</th>
                            <th scope="col" style="width:240px;">Descripción</th>
                            <th scope="col" style="width:270px;">Usuario asignado</th>
                            <th scope="col" style="width:40px;"> </th>
                        </tr>
                    </thead>
                    <tbody translate="no" class="text-dark fuente75">
                        <tr *ngFor="let item of estados">
                            <td>
                                <a (click)="cambiandoEstado(item)" class="has-arrow waves-effect text-dark" style="margin-top:10px;">
                                    <i *ngIf="  item.marcada " class="mdi mdi-check mdi-24px"></i>
                                    <i *ngIf=" !item.marcada " class="mdi mdi-checkbox-blank-circle-outline mdi-24px"></i>
                                </a>
                            </td>
                            <td scope="row" class="sinBorde">
                                <p>{{item.estado}}</p>
                            </td>
                            <td scope="row" class="sinBorde">
                                <p>{{ item.descripcion }}</p>
                            </td>
                            <td scope="row" class="sinBorde">
                                <p>{{ item.nombre }}</p>
                            </td>
                            <td scope="row" class="sinBorde">
                                <a *ngIf=" item.marcada " (click)="cambiarUsuario( item )" data-toggle="modal" data-target="#buscarUsuario" class="has-arrow waves-effect text-dark">
                                    <i class="mdi mdi-account-search mdi-24px"></i>
                                </a>&nbsp;
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <div class="custom-control custom-checkbox text-left">
                    <input type="checkbox" class="custom-control-input" id="customCheck1" name="cerrarPQT" [(ngModel)]="cerrarPQT">
                    <label class="custom-control-label" for="customCheck1" style="left:-120px;"><b>Cerrar esta Encomienda</b></label>
                </div>
                <div class="custom-control text-right">
                    <button type="button" class="btn btn-secondary text-right" data-dismiss="modal" style="margin-right: 10px;">Abandonar</button>
                    <button type="button" class="btn btn-primary text-right" data-dismiss="modal" (click)="updateEstados()">Actualizar Estado</button>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Modal buscar usuarios -->
<div class="modal fade" id="buscarUsuario" tabindex="-1" role="dialog" aria-labelledby="#buscarUsuario" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-striped" style="max-width: 950px;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Usuarios del sistema</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <table class="table table-sm">
                    <thead class="bg-dark text-light">
                        <tr translate="no">
                            <th scope="col" style="width:100px;">id</th>
                            <th scope="col" style="width:250px;">Nombre</th>
                            <th scope="col" style="width:250px;">e-Mail</th>
                            <th scope="col" style="width:100px;">Teléfono</th>
                        </tr>
                    </thead>
                    <tbody translate="no" class="text-dark fuente75">
                        <tr *ngFor="let item of login.usuarios" data-dismiss="modal" (click)="esteUsuario( item )">
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{item.id}}</p>
                            </td>
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{ item.nombre }}</p>
                            </td>
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{ item.email }}</p>
                            </td>
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{ item.telefono }}</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>
<!-- Modal cambio de estados masivos de la encomienda -->
<div class="modal fade" id="EditEstadosMasivos" tabindex="-1" role="dialog" aria-labelledby="EditEstadosMasivosLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered" role="document">
        <div class="modal-content" style="width:670px;">
            <div class="modal-header">
                <h4 class="modal-title" id="ModalCenteredCrearLabel">Estados de las Encomiendas <b>MASIVO</b></h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body modal-body-scroll">
                <table class="table table-sm table-striped table-condensed" cellpadding="0" cellspacing="0">
                    <thead class="bg-dark text-light">
                        <tr translate="no">
                            <th scope="col" style="width:40px;"> </th>
                            <th scope="col" style="width:90px;">Estado</th>
                            <th scope="col" style="width:240px;">Descripción</th>
                            <th scope="col" style="width:270px;">Usuario asignado</th>
                            <th scope="col" style="width:40px;"> </th>
                        </tr>
                    </thead>
                    <tbody translate="no" class="text-dark fuente75">
                        <tr *ngFor="let item of estados">
                            <td>
                                <a (click)="cambiandoEstado(item)" class="has-arrow waves-effect text-dark" style="margin-top:10px;">
                                    <i *ngIf="  item.marcada " class="mdi mdi-check mdi-24px"></i>
                                    <i *ngIf=" !item.marcada " class="mdi mdi-checkbox-blank-circle-outline mdi-24px"></i>
                                </a>
                            </td>
                            <td scope="row" class="sinBorde">
                                <p>{{item.estado}}</p>
                            </td>
                            <td scope="row" class="sinBorde">
                                <p>{{ item.descripcion }}</p>
                            </td>
                            <td scope="row" class="sinBorde">
                                <p>{{ item.nombre }}</p>
                            </td>
                            <td scope="row" class="sinBorde">
                                <a *ngIf=" item.marcada " (click)="cambiarUsuario( item )" data-toggle="modal" data-target="#buscarUsuario" class="has-arrow waves-effect text-dark">
                                    <i class="mdi mdi-account-search mdi-24px"></i>
                                </a>&nbsp;
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <div class="custom-control custom-checkbox text-left">
                    <input type="checkbox" class="custom-control-input" id="customCheck1" name="cerrarPQT" [(ngModel)]="cerrarPQT">
                    <label class="custom-control-label" for="customCheck1" style="left:-70px;"><b>Cerrar Encomiendas Marcadas</b></label>
                </div>
                <div class="custom-control text-right">
                    <button type="button" class="btn btn-secondary text-right" data-dismiss="modal" style="margin-right: 10px;">Abandonar</button>
                    <button type="button" class="btn btn-primary text-right" data-dismiss="modal" (click)="updateEstadosMasivos()">Actualizar Estado</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- fin modal -->