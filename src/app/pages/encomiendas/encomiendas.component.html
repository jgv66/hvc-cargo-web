<nav>
    <div class="nav nav-tabs" id="nav-tab" role="tablist">
        <a class="nav-item nav-link" id="nav-contact-tab" data-toggle="tab" href="#nav-contact" role="tab" aria-controls="nav-contact" aria-selected="false"><b>Encomiendas</b></a>
        <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true"><b>Retiros</b></a>
        <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab" aria-controls="nav-profile" aria-selected="false"><b>Acopios</b></a>
        <a class="nav-item nav-link" id="nav-follow-tab" data-toggle="tab" href="#nav-follow" role="tab" aria-controls="nav-seguimiento" aria-selected="false"><b>Seguimientos</b></a>
        <a class="nav-item nav-link" id="nav-cliente-tab" data-toggle="tab" href="#nav-cliente" role="tab" aria-controls="nav-ccliente" aria-selected="false"><b>Clientes</b></a>
        <!-- <a class="nav-item nav-link" id="nav-datatables" data-toggle="tab" href="#nav-datatable" role="tab" aria-controls="nav-datatables" aria-selected="false"><b>DataTables</b></a> -->
    </div>
</nav>
<div class="tab-content" id="nav-tabContent">
    <!-- Nueva Encomienda -->
    <div class="tab-pane fade" id="nav-contact" role="tabpanel" aria-labelledby="nav-contact-tab">
        <div classs="card" style="margin-top: 5px;">
            <div class="progress" *ngIf=" grabando ">
                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;height: 5px;"></div>
            </div>
            <form (ngSubmit)="crearEncomienda()">
                <!-- datos cliente / despachante -->
                <div class="card" style="width: 100%;margin-top:10px;font-size:90%;">
                    <div class="card-body">
                        <h3 class="card-title"><b>Datos del Origen</b></h3>
                        <div class="row" style="margin-top: -38px;">
                            <div class="col-1" style="margin-top: 29px;padding-left:15px;padding-right:5px;">
                                <button type="button" (click)="limpiaDataChica()" data-toggle="modal" data-target="#buscarClientes" class="btn btn-primary btn-block">Buscar</button>
                            </div>
                            <div class="col-4">
                                <label>.</label>
                                <input readonly type="text" class="form-control" name="carga.xnombreCliente" [(ngModel)]="carga.xnombreCliente">
                            </div>
                            <div class="col-2">
                                <label>Rut</label>
                                <input readonly type="text" class="form-control" name="carga.xrutCliente" [(ngModel)]="carga.xrutCliente">
                            </div>
                            <div class="col-3">
                                <label>Email</label>
                                <input readonly type="text" class="form-control" name="carga.xemailCliente" [(ngModel)]="carga.xemailCliente">
                            </div>
                            <div class="col-2">
                                <label>Telefonos</label>
                                <input readonly type="text" class="form-control" name="carga.xfonosCliente" [(ngModel)]="carga.xfonosCliente">
                            </div>
                        </div>
                        <div class="row" style="margin-top: 10px;">
                            <div class="col-md-3">
                                <label>Dirección</label>
                                <input readonly type="text" class="form-control" name="carga.xdireccCliente" [(ngModel)]="carga.xdireccCliente">
                            </div>
                            <div class="col-md-4">
                                <label>Comuna</label>
                                <input readonly type="text" class="form-control" name="carga.xcomunaCliente" [(ngModel)]="carga.xcomunaCliente">
                            </div>
                            <div class="col-md-3">
                                <label>Contacto o Quién entrega?</label>
                                <input clearInput="true" type="text" class="form-control" name="carga.contacto" [(ngModel)]="carga.contacto">
                            </div>
                            <div class="col-md-2" style="padding-left: 5px;">
                                <label>Fecha en destino</label>
                                <input clearInput="true" type="date" class="form-control" name="fecha_prometida" [(ngModel)]="carga.fecha_prometida">
                            </div>
                        </div>
                        <div class="row" style="margin-top: 10px;">
                            <div class="col-md-2">
                                <label>Tipo de Carga</label>
                                <input clearInput="true" type="text" class="form-control" name="carga.obs_carga" [(ngModel)]="carga.obs_carga">
                            </div>
                            <div class="col-md-1">
                                <label>Bultos</label>
                                <input clearInput="true" type="number" class="form-control" name="carga.bultos" [(ngModel)]="carga.bultos">
                            </div>
                            <div class="col-md-1" style="padding-left: 5px;">
                                <label>Peso (Kg)</label>
                                <input clearInput="true" type="number" class="form-control" name="carga.peso" [(ngModel)]="carga.peso">
                            </div>
                            <div class="col-md-1" style="padding-left: 5px;">
                                <label>Vol.(m3)</label>
                                <input clearInput="true" type="number" class="form-control" name="carga.volumen" [(ngModel)]="carga.volumen">
                            </div>
                            <div class="col-md-2">
                                <label>Tipo y Nro.de Documento</label>
                                <input clearInput="true" type="text" class="form-control" name="carga.numero_legal" [(ngModel)]="carga.numero_legal">
                            </div>
                            <div class="col-md-3">
                                <label>Tipo Pago</label>
                                <select class="form-control text-left" name="carga.tipo_pago" [(ngModel)]="carga.tipo_pago">
                                    <option value=""></option>
                                    <option *ngFor="let tp of login.tiposDePago" [value]="tp.tipo_pago">{{ tp.descripcion }}</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label>Valor Encomienda</label>
                                <input clearInput="true" type="number" class="form-control" name="carga.valor_cobrado" [(ngModel)]="carga.valor_cobrado">
                            </div>
                        </div>
                    </div>
                </div>
                <!-- datos del destino / receptor -->
                <div class="card" style="width: 100%;margin-top:10px;font-size:90%;">
                    <div class="card-body">
                        <h3 class="card-title"><b>Datos del Destinatario</b></h3>
                        <div class="row" style="margin-top: -38px;">
                            <div class="col-1" style="margin-top: 29px;padding-left:15px;padding-right:5px;">
                                <button type="button" (click)="limpiaDataChica()" data-toggle="modal" data-target="#buscarDestinos" class="btn btn-primary btn-block">Buscar</button>
                            </div>
                            <div class="col-4">
                                <label>.</label>
                                <input readonly type="text" class="form-control" name="carga.xnombreDestino" [(ngModel)]="carga.xnombreDestino">
                            </div>
                            <div class="col-2">
                                <label>Rut</label>
                                <input readonly type="text" class="form-control" name="carga.xrutDestino" [(ngModel)]="carga.xrutDestino">
                            </div>
                            <div class="col-3">
                                <label>Email</label>
                                <input readonly type="text" class="form-control" name="carga.xemailDestino" [(ngModel)]="carga.xemailDestino">
                            </div>
                            <div class="col-2">
                                <label>Telefonos</label>
                                <input readonly type="text" class="form-control" name="carga.xfonosDestino" [(ngModel)]="carga.xfonosDestino">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <label>Dirección</label>
                                <input readonly type="text" class="form-control" name="carga.xdireccDestino" [(ngModel)]="carga.xdireccDestino">
                            </div>
                            <div class="col-md-5">
                                <label>Comuna</label>
                                <input readonly type="text" class="form-control" name="carga.xcomunaDestino" [(ngModel)]="carga.xcomunaDestino">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="progress" *ngIf=" grabandoEnco ">
                    <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;height: 5px;"></div>
                </div>
                <button type="submit" class="btn btn-primary">Grabar los datos de Encomienda</button>
            </form>
        </div>
    </div>
    <!-- Retiros -->
    <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
        <!-- sector de retiro -->
        <button type="button" class="btn btn-link text-right" (click)="cargarDatosPendientes()" style="position: absolute;float: right;right: 26px;top: 140px;">
            <i class="mdi mdi-refresh mdi-36px"></i>
        </button>
        <div classs="card" style="margin-top: 5px;">
            <div class="progress" *ngIf=" buscandoRetiros ">
                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;height: 5px;"></div>
            </div>
            <table class="table table-striped table-hover table-sm">
                <thead class="bg-dark text-light">
                    <tr translate="no">
                        <th scope="col" style="width:370px;">#Seguimiento / Cliente</th>
                        <th scope="col" style="width:320px;">Destinatario</th>
                        <th scope="col" style="width:150px;">Encomienda</th>
                        <th scope="col" style="width:150px;">Fechas</th>
                        <th scope="col" style="width:150px;">Cobro</th>
                        <th scope="col" style="width:200px;">Estado</th>
                        <th scope="col" style="width:150px;text-align:center;">Acción</th>
                    </tr>
                </thead>
                <tbody translate="no" class="text-dark fuente75">
                    <tr *ngFor="let item of retiros">
                        <td colspan="7" style="width:100%">
                            <table style="width:100%; border-collapse: none !important; border-spacing: 0px!important;">
                                <tr>
                                    <td style="padding-top: 18px;width:370px;" scope="row">
                                        <p> <a data-toggle="collapse" href="#id-{{item.id_paquete}}" role="button" aria-expanded="false" aria-controls="collapseExample">( <b>#{{item.id_paquete}}</b> )</a> {{item.cli_razon}}</p>
                                    </td>
                                    <td style="padding-top: 18px;width:320px;" scope="row">
                                        <p>{{ item.des_razon }}</p>
                                    </td>
                                    <td style="padding-top: 18px;width:150px;" scope="row">
                                        <p>{{ item.obs_carga }}</p>
                                    </td>
                                    <td style="padding-top: 18px;width:150px;" scope="row">
                                        <p><i class="mdi mdi-calendar-clock mdi-18px"></i> {{ item.fecha_creacion }}</p>
                                    </td>
                                    <td style="padding-top: 18px;width:150px; font-weight: bold; color: red" scope="row">
                                        <p>{{ item.tipo_pago }}</p>
                                    </td>
                                    <td style="padding-top: 18px;width:200px;" scope="row">
                                        <p><i class="mdi mdi-comment-question-outline mdi-18px"></i> {{ item.estado }}</p>
                                    </td>
                                    <td class="text-center" style="width:150px;">
                                        <a *ngIf=" login.usuario.admin " (click)="revisarEncomienda( item )" data-toggle="modal" data-target="#EditEncomienda" class="has-arrow waves-effect text-dark" style="margin-top:10px;">
                                            <i class="mdi mdi-lead-pencil mdi-24px"></i>
                                        </a>&nbsp;
                                        <a *ngIf=" login.usuario.admin " (click)="cambiodeEstado( item )" data-toggle="modal" data-target="#EditEstados" class="has-arrow waves-effect text-dark" style="margin-top:10px;">
                                            <i class="mdi mdi-checkbox-marked-circle-outline mdi-24px "></i>
                                        </a>&nbsp;
                                        <a *ngIf=" login.usuario.admin " (click)="borrarEncomienda( item )" class="has-arrow waves-effect text-dark" style="margin-top:10px;">
                                            <i class="mdi mdi-delete mdi-24px "></i>
                                        </a>
                                    </td>
                                </tr>
                                <tr class="collapse" id="id-{{item.id_paquete}}">
                                    <td scope="row">
                                        <p>{{ item.cli_direccion }}, {{ item.cli_comuna}} </p>
                                        <p>{{ item.contacto }}</p>
                                        <p>{{ item.cli_referencias }}</p>
                                    </td>
                                    <td scope="row">
                                        <p>{{ item.des_direccion }}, {{ item.des_comuna}} </p>
                                    </td>
                                    <td scope="row">
                                        <p><i class="mdi mdi-package-variant-closed mdi-18px"></i> {{ item.bultos }} </p>
                                        <p><i class="mdi mdi-weight-kilogram mdi-18px"></i> {{ item.peso | number:"1.0-2" }}Kg </p>
                                    </td>
                                    <td scope="row">
                                        <p><i class="mdi mdi-clock-fast mdi-18px"></i> {{ item.hora_creacion }}</p>
                                        <p><i class="mdi mdi-calendar-question mdi-18px"></i> {{ item.fecha_prometida }}</p>
                                    </td>
                                    <td style="padding-top: 18px; font-weight: bold; color: red" scope="row">
                                        <p>${{ item.valor_cobrado | number:"1.0-0"}}</p>
                                    </td>
                                    <td scope="row">
                                        <p><i class="mdi mdi-calendar-clock mdi-18px"></i> {{ item.asignacion }}</p>
                                        <p><i class="mdi mdi-clock-fast mdi-18px"></i> {{ item.hora_asignacion }}</p>
                                        <p><i class="mdi mdi-account-settings mdi-18px"></i> {{ item.pickeador }}</p>
                                    </td>
                                    <td class="text-center">
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <!-- Acopios -->
    <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
        <!-- sector de acopios -->
        <button type="button" class="btn btn-link text-right" (click)="cargarDatosAcopio()" style="position: absolute;float: right;right: 26px;top: 140px;">
            <i class="mdi mdi-refresh mdi-36px"></i>
        </button>

        <div classs="card" style="margin-top: 5px;">
            <table class="table table-striped table-hover table-sm">
                <thead class="bg-success text-light">
                    <tr translate="no">
                        <th scope="col" style="width:300px;">#Seguimiento / Cliente</th>
                        <th scope="col" style="width:360px;">Destinatario</th>
                        <th scope="col" style="width:180px;">Encomienda</th>
                        <th scope="col" style="width:150px;">Fechas</th>
                        <th scope="col" style="width:150px;">Cobro</th>
                        <th scope="col" style="width:200px;">Estado</th>
                        <th scope="col" style="width:150px;text-align:center;">Acción</th>
                    </tr>
                </thead>
                <tbody translate="no" class="text-dark fuente75">
                    <tr *ngFor="let item of acopios">
                        <td colspan="7" style="width:100%">
                            <table style="width:100%; border-collapse: none !important; border-spacing: 0px!important;">
                                <!-- parte superior -->
                                <tr>
                                    <td style="padding-top: 18px; width:300px;" scope="row">
                                        <p>
                                            <a data-toggle="collapse" href="#id-{{item.id_paquete}}" role="button" aria-expanded="false" aria-controls="collapseExample">
                                                ( <b>#{{item.id_paquete}}</b> )
                                            </a> {{item.cli_razon}}
                                        </p>
                                    </td>
                                    <td style="padding-top: 18px;width:360px;" scope="row">
                                        <p>{{ item.des_razon }}</p>
                                    </td>
                                    <td style="padding-top: 18px;width:180px;" scope="row">
                                        <p>{{ item.obs_carga }}</p>
                                    </td>
                                    <td style="padding-top: 18px;width:150px;" scope="row">
                                        <p><i class="mdi mdi-calendar-clock mdi-18px"></i> {{ item.fecha_creacion }}</p>
                                    </td>
                                    <td style="padding-top: 18px; font-weight: bold; color: red; width:150px;" scope="row">
                                        <p>{{ item.tipo_pago }}</p>
                                    </td>
                                    <td style="padding-top: 18px;width:200px;" scope="row">
                                        <p><i class="mdi mdi-comment-question-outline mdi-18px"></i> {{ item.estado }}</p>
                                    </td>
                                    <td class="text-center" style="width:150px;">
                                        <a (click)="cargarFoto( item )" data-toggle="modal" data-target="#exampleModal" class="has-arrow waves-effect text-dark" style="margin-top: 10px;">
                                            <i class="mdi mdi-camera mdi-24px"></i>
                                        </a>&nbsp;
                                        <a *ngIf=" login.usuario.admin " (click)="revisarEncomienda( item )" data-toggle="modal" data-target="#EditEncomienda" class="has-arrow waves-effect text-dark" style="margin-top:10px;">
                                            <i class="mdi mdi-lead-pencil mdi-24px"></i>
                                        </a>&nbsp;
                                        <a *ngIf=" login.usuario.admin " (click)="borrarEncomienda( item )" class="has-arrow waves-effect text-dark" style="margin-top: 10px;">
                                            <i class="mdi mdi-delete-circle mdi-24px"></i>
                                        </a>
                                    </td>
                                </tr>
                                <tr class="collapse" id="id-{{item.id_paquete}}">
                                    <td scope="row">
                                        <p>{{ item.cli_direccion }}, {{ item.cli_comuna}} </p>
                                        <p>{{ item.contacto }}</p>
                                        <p>{{ item.cli_referencias }}</p>
                                    </td>
                                    <td scope="row">
                                        <p>{{ item.des_direccion }}, {{ item.des_comuna}} </p>
                                    </td>
                                    <td scope="row">
                                        <p><i class="mdi mdi-package-variant-closed mdi-18px"></i> {{ item.bultos }} </p>
                                        <p><i class="mdi mdi-weight-kilogram mdi-18px"></i> {{ item.peso | number:"1.0-2" }}Kg </p>
                                    </td>
                                    <td scope="row">
                                        <p><i class="mdi mdi-clock-fast mdi-18px"></i> {{ item.hora_creacion }}</p>
                                        <p><i class="mdi mdi-calendar-question mdi-18px"></i> {{ item.fecha_prometida }}</p>
                                    </td>
                                    <td scope="row" style="font-weight: bold; color: red;">
                                        <p>${{ item.valor_cobrado | number:"1.0-0"}}</p>
                                    </td>
                                    <td scope="row">
                                        <p><i class="mdi mdi-calendar-clock mdi-18px"></i> {{ item.asignacion }}</p>
                                        <p><i class="mdi mdi-clock-fast mdi-18px"></i> {{ item.hora_asignacion }}</p>
                                        <p><i class="mdi mdi-account-settings mdi-18px"></i> {{ item.pickeador }}</p>
                                    </td>
                                    <td>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <!-- clientes -->
    <div class="tab-pane fade" id="nav-cliente" role="tabpanel" aria-labelledby="nav-cliente-tab">
        <div classs="card" style="margin-top: 5px;">
            <!-- buscar clientes -->
            <form (ngSubmit)="buscarClientes()">
                <div class="form-row mt-2">
                    <div class="col-8">
                        <label class="col-2 col-form-label text-left">Buscar cliente</label>
                        <input class="col-10 form-control" type="text" name="nombreorut" [(ngModel)]="nombreorut" placeholder="digite algo del nombre o rut...">
                    </div>
                    <div class="col-1">
                        <button type="submit" class="btn btn-outline-dark mb-2">Buscar</button>
                    </div>
                    <button type="button" class="btn btn-link text-right" style="padding-top: 0px;" (click)="limpiar()">
                        <i class="mdi mdi-refresh mdi-36px"></i>
                    </button>
                    <button type="button" class="btn btn-link text-right" style="padding-top: 0px;" (click)="crearCliente()" data-toggle="modal" data-target="#ModalCenteredCrear">
                        <i class="mdi mdi-plus-circle-outline mdi-36px"></i>
                    </button>
                </div>
            </form>
            <div class="progress" *ngIf=" buscando ">
                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;height: 5px;"></div>
            </div>

            <!-- grilla de clientes -->
            <table class="table table-striped table-sm">
                <thead class="bg-dark text-light">
                    <tr translate="no">
                        <th scope="col" style="width:100px;">RUT</th>
                        <th scope="col" style="width:350px;">Razon Social / Nombre Fantasía</th>
                        <th scope="col" style="width:400px;">Direccion / Comuna</th>
                        <th scope="col" style="width:150px;">Teléfonos</th>
                        <th scope="col" style="width:200px;">Email</th>
                        <th scope="col" style="width:100px;text-align:center;">Acción</th>
                    </tr>
                </thead>
                <tbody translate="no" class="text-dark fuente75">
                    <tr *ngFor="let item of clientes">
                        <td style="padding-top: 18px;" scope="row">
                            <p>{{item.rut}}</p>
                        </td>
                        <td style="padding-top: 18px;" scope="row">
                            <p>{{ item.razon_social }}</p>
                            <p>{{ item.nombre_fantasia }}</p>
                        </td>
                        <td style="padding-top: 18px;" scope="row">
                            <p>{{ item.direccion }}</p>
                            <p>{{ item.comuna }}</p>
                        </td>
                        <td style="padding-top: 18px;" scope="row">
                            <p>{{ item.telefono1 }} - {{ item.telefono2 }}</p>
                        </td>
                        <td style="padding-top: 18px;" scope="row">
                            <p>{{ item.email }}</p>
                        </td>
                        <td class="text-center">
                            <a (click)="editarCliente( item )" data-toggle="modal" data-target="#ModalCenteredCrear" class="has-arrow waves-effect text-dark" style="margin-top:10px;"><i class="mdi mdi-lead-pencil mdi-24px"></i></a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <!-- seguimientos -->
    <div class="tab-pane fade" id="nav-follow" role="tabpanel" aria-labelledby="nav-seguimiento-tab">
        <div classs="card" style="margin-top: 5px;">
            <!-- buscar paquete -->
            <form (ngSubmit)="buscarPaquete()">
                <div class="form-row mt-2">
                    <div class="col-6">
                        <label class="col-3 col-form-label text-left">Encomienda #</label>
                        <input class="col-4 form-control" type="text" name="idpqt" [(ngModel)]="idpqt" placeholder="digite el ID de seguimiento...">
                        <button type="submit" class="btn btn-outline-dark mb-2" style="padding-top:7px; margin-top: 5px; margin-left: 10px;">Buscar</button>
                    </div>
                    <div class="col-1">
                    </div>
                </div>
            </form>
            <div class="progress" *ngIf=" buscandoID ">
                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;height: 5px;"></div>
            </div>

            <!-- grilla de clientes -->
            <table class="table table-striped table-sm">
                <thead class="bg-dark text-light">
                    <tr translate="no">
                        <th scope="col" style="width:150px;">#Seguimiento</th>
                        <th scope="col" style="width:150px;">Fecha</th>
                        <th scope="col" style="width:120px;">Hora</th>
                        <th scope="col" style="width:300px;">Usuario</th>
                        <th scope="col" style="width:350px;">Comentario</th>
                    </tr>
                </thead>
                <tbody translate="no" class="text-dark fuente75">
                    <tr *ngFor="let item of estadosPqt">
                        <td style="padding-top: 18px;" scope="row">
                            <p>{{item.id_paquete}}</p>
                        </td>
                        <td style="padding-top: 18px;" scope="row">
                            <p>{{item.fecha}}</p>
                        </td>
                        <td style="padding-top: 18px;" scope="row">
                            <p>{{ item.hora }}</p>
                        </td>
                        <td style="padding-top: 18px;" scope="row">
                            <p>{{ item.nombre }}</p>
                        </td>
                        <td style="padding-top: 18px;" scope="row">
                            <p>{{ item.comentario }}</p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Modal que despliega la foto -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content" style="width: 670px;">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Imagen del Retiro ( <b>#{{ idfoto }}</b> )</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
            </div>
            <div class="modal-body">
                <img [src]="foto">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal buscar clientes -->
<div class="modal fade" id="buscarClientes" tabindex="-1" role="dialog" aria-labelledby="#buscarClientes" aria-hidden="true">
    <div class="modal-dialog modal-xl" style="max-width: 950px;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Buscar clientes</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <!-- buscar clientes -->
            <div class="row" style="margin-top: 10px;">
                <div class="col-10" style="margin-top: 10px; border-left-width: 17px; margin-left: 17px;">
                    <input class="form-control col-9" type="text" name="buscarCliente" [(ngModel)]="buscarCliente">
                </div>
                <div class="col-1" style="margin-top: 10px;">
                    <button type="button" (click)="buscarClientesChico()" class="btn btn-outline-dark mb-2">Buscar</button>
                </div>
            </div>
            <div class="progress" *ngIf=" buscandoChico ">
                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;height: 5px;"></div>
            </div>

            <div class="modal-body">
                <table class="table table-sm">
                    <thead class="bg-dark text-light">
                        <tr translate="no">
                            <th scope="col" style="width:100px;">RUT</th>
                            <th scope="col" style="width:250px;">Razón Social</th>
                            <th scope="col" style="width:300px;">Dirección</th>
                            <th scope="col" style="width:200px;">Comuna</th>
                        </tr>
                    </thead>
                    <tbody translate="no" class="text-dark fuente75">
                        <tr *ngFor="let item of clienteChico" data-dismiss="modal" (click)="esteClienteDestino( item, true )">
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{item.rut}}</p>
                            </td>
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{ item.razon_social }}</p>
                                <p>{{ item.nombre_fantasia }}</p>
                            </td>
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{ item.direccion }}</p>
                            </td>
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{ item.comuna }}</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal buscar destinatarios -->
<div class="modal fade" id="buscarDestinos" tabindex="-1" role="dialog" aria-labelledby="#buscarDestinos" aria-hidden="true">
    <div class="modal-dialog modal-xl" style="max-width: 950px;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Buscar Destinatarios</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <!-- buscar clientes -->
            <div class="row" style="margin-top: 10px;">
                <div class="col-10" style="margin-top: 10px; border-left-width: 17px; margin-left: 17px;">
                    <input class="form-control col-9" type="text" name="buscarCliente" [(ngModel)]="buscarCliente">
                </div>
                <div class="col-1" style="margin-top: 10px;">
                    <button type="button" (click)="buscarClientesChico()" class="btn btn-outline-dark mb-2">Buscar</button>
                </div>
            </div>
            <div class="progress" *ngIf=" buscandoChico ">
                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;height: 5px;"></div>
            </div>

            <div class="modal-body">
                <table class="table table-sm">
                    <thead class="bg-dark text-light">
                        <tr translate="no">
                            <th scope="col" style="width:100px;">RUT</th>
                            <th scope="col" style="width:250px;">Razón Social</th>
                            <th scope="col" style="width:300px;">Dirección</th>
                            <th scope="col" style="width:200px;">Comuna</th>
                        </tr>
                    </thead>
                    <tbody translate="no" class="text-dark fuente75">
                        <tr *ngFor="let item of clienteChico" data-dismiss="modal" (click)="esteClienteDestino( item, false )">
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{item.rut}}</p>
                            </td>
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{ item.razon_social }}</p>
                                <p>{{ item.nombre_fantasia }}</p>
                            </td>
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{ item.direccion }}</p>
                            </td>
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{ item.comuna }}</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal crear/modificar cliente -->
<div class="modal fade" id="ModalCenteredCrear" tabindex="-1" role="dialog" aria-labelledby="ModalCenteredCrearLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content" style="width: 670px;">
            <div class="modal-header">
                <h4 class="modal-title" id="ModalCenteredCrearLabel">Mantención de Clientes</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="row" style="margin-top: 10px;">
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label">Rut</label>
                        <input class="form-control col-9" type="text" name="xrut" [(ngModel)]="linea.rut">
                    </div>
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label">Nombre</label>
                        <input class="form-control col-9" type="text" name="razon_social" [(ngModel)]="linea.razon_social">
                    </div>
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label">Nombre fantasia</label>
                        <input class="form-control col-9" type="text" name="razon_fantasia" [(ngModel)]="linea.nombre_fantasia">
                    </div>
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label">Dirección</label>
                        <input class="form-control col-9" type="text" name="direccion" [(ngModel)]="linea.direccion">
                    </div>
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label text-left">Comuna</label>
                        <select class="form-control col-9 text-left" name="comuna" [(ngModel)]="linea.comuna">
                          <option value="">Seleccione una comuna</option>
                          <option *ngFor="let comu of login.ciudadesPermitidas" [value]="comu.ciudad">{{ comu.ciudad }}</option>
                        </select>
                    </div>
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label">Teléfono (1)</label>
                        <input class="form-control col-9" type="text" name="telefono1" [(ngModel)]="linea.telefono1">
                    </div>
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label">Teléfono (2)</label>
                        <input class="form-control col-9" type="text" name="telefono2" [(ngModel)]="linea.telefono2">
                    </div>
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label">e-Mail</label>
                        <input class="form-control col-9" type="mail" name="email" [(ngModel)]="linea.email">
                    </div>
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label">Referencias</label>
                        <input class="form-control col-9" type="text" name="referencias" [(ngModel)]="linea.referencias" placeholder="ubicacion o proximidad o cruce...">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="grabarCliente()">Grabar y actualizar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal editar encomienda -->
<div class="modal fade" id="EditEncomienda" tabindex="-1" role="dialog" aria-labelledby="EditEncomiendaLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content" style="width: 670px;">
            <div class="modal-header">
                <h4 class="modal-title" id="ModalCenteredCrearLabel">Datos Editables de la Encomienda <b>( #{{ encomienda['id_paquete'] }} )</b></h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="row" style="margin-top: 10px;">
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label">Cliente</label>
                        <input readonly class="form-control col-9" type="text" name="razon" [(ngModel)]="encomienda['cli_razon']">
                    </div>
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label">Contacto</label>
                        <input class="form-control col-9" type="text" name="contacto" [(ngModel)]="encomienda['contacto']">
                    </div>
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label">Fecha destino</label>
                        <input class="form-control col-4" type="date" name="encomienda.llegada" [(ngModel)]="encomienda['llegada']">
                        <label class="col-2 col-form-label text-right">Valor</label>
                        <input class="form-control col-3" type="number" name="valor" [(ngModel)]="encomienda['valor_cobrado']">
                    </div>
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label text-left">Tipo Pago</label>
                        <select class="form-control text-left col-9" name="tipo_pago" [(ngModel)]="encomienda['tipo_pago']" styles="max-width: 478px;">
                            <option value=""></option>
                            <option *ngFor="let tp of login.tiposDePago" [value]="tp.tipo_pago">{{ tp.descripcion }}</option>
                        </select>
                    </div>
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label">Tipo Carga</label>
                        <input class="form-control col-9" type="text" name="carga" [(ngModel)]="encomienda['obs_carga']">
                    </div>
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label">Bultos</label>
                        <input class="form-control col-3" type="number" name="bultos" [(ngModel)]="encomienda['bultos']">
                        <label class="col-3 col-form-label text-right">Peso (Kg)</label>
                        <input class="form-control col-3" type="number" name="peso" [(ngModel)]="encomienda['peso']">
                    </div>
                    <div class="col-12" style="margin-top: 10px;">
                        <label class="col-3 col-form-label">Volumen (m3)</label>
                        <input class="form-control col-2" type="number" name="volumen" [(ngModel)]="encomienda['volumen']">
                        <label class="col-4 col-form-label text-right">Tipo y Nro.Doc.Legal</label>
                        <input class="form-control col-3" type="text" name="numero_legal" [(ngModel)]="encomienda['numero_legal']">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="updateEncomienda()">Grabar y actualizar</button>
            </div>
        </div>
    </div>
    <!-- 
                </div>
         -->
</div>

<!-- Modal estados de la encomienda -->
<div class="modal fade" id="EditEstados" tabindex="-1" role="dialog" aria-labelledby="EditEstadosLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered" role="document">
        <div class="modal-content" style="width:670px;">
            <div class="modal-header">
                <h4 class="modal-title" id="ModalCenteredCrearLabel">Estados de la Encomienda <b>( #{{ this.idpqt }} )</b></h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body modal-body-scroll">
                <table class="table table-sm table-striped table-condensed" cellpadding="0" cellspacing="0">
                    <thead class="bg-dark text-light">
                        <tr translate="no">
                            <th scope="col" style="width:40px;"> </th>
                            <th scope="col" style="width:90px;">Estado</th>
                            <th scope="col" style="width:240px;">Descripción</th>
                            <th scope="col" style="width:270px;">Usuario asignado</th>
                            <th scope="col" style="width:40px;"> </th>
                        </tr>
                    </thead>
                    <tbody translate="no" class="text-dark fuente75">
                        <tr *ngFor="let item of estados">
                            <td>
                                <a (click)="cambiandoEstado(item)" class="has-arrow waves-effect text-dark" style="margin-top:10px;">
                                    <i *ngIf="  item.marcada " class="mdi mdi-check mdi-24px"></i>
                                    <i *ngIf=" !item.marcada " class="mdi mdi-checkbox-blank-circle-outline mdi-24px"></i>
                                </a>
                            </td>
                            <td scope="row" class="sinBorde">
                                <p>{{item.estado}}</p>
                            </td>
                            <td scope="row" class="sinBorde">
                                <p>{{ item.descripcion }}</p>
                            </td>
                            <td scope="row" class="sinBorde">
                                <p>{{ item.nombre }}</p>
                            </td>
                            <td scope="row" class="sinBorde">
                                <a *ngIf=" item.marcada " (click)="cambiarUsuario( item )" data-toggle="modal" data-target="#buscarUsuario" class="has-arrow waves-effect text-dark">
                                    <i class="mdi mdi-account-search mdi-24px"></i>
                                </a>&nbsp;
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <div class="custom-control custom-checkbox text-left">
                    <input type="checkbox" class="custom-control-input" id="customCheck1" name="cerrarPQT" [(ngModel)]="cerrarPQT">
                    <label class="custom-control-label" for="customCheck1" style="left:-120px;"><b>Cerrar esta Encomienda</b></label>
                </div>
                <div class="custom-control text-right">
                    <button type="button" class="btn btn-secondary text-right" data-dismiss="modal" style="margin-right: 10px;">Abandonar</button>
                    <button type="button" class="btn btn-primary text-right" data-dismiss="modal" (click)="updateEstados()">Actualizar Estado</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal buscar usuarios -->
<div class="modal fade" id="buscarUsuario" tabindex="-1" role="dialog" aria-labelledby="#buscarUsuario" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-striped" style="max-width: 950px;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Usuarios del sistema</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <table class="table table-sm">
                    <thead class="bg-dark text-light">
                        <tr translate="no">
                            <th scope="col" style="width:100px;">id</th>
                            <th scope="col" style="width:250px;">Nombre</th>
                            <th scope="col" style="width:250px;">e-Mail</th>
                            <th scope="col" style="width:100px;">Teléfono</th>
                        </tr>
                    </thead>
                    <tbody translate="no" class="text-dark fuente75">
                        <tr *ngFor="let item of login.usuarios" data-dismiss="modal" (click)="esteUsuario( item )">
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{item.id}}</p>
                            </td>
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{ item.nombre }}</p>
                            </td>
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{ item.email }}</p>
                            </td>
                            <td style="padding-top: 18px;" scope="row">
                                <p>{{ item.telefono }}</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

<!-- fin modal -->